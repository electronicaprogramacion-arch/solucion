@namespace Blazor.Controls
@typeparam TValue
@using Helpers.Controls
@using Helpers
@inherits Blazor.Controls.TextInputBase<TValue>


@if (string.IsNullOrEmpty(Type) && ChildContent == null)
{
    Type = "text";
}
else
if (string.IsNullOrEmpty(Type) && ChildContent != null)
{
    Type = "select";
}

@if (Type.ToLower().Trim() == "readonly")
{
    //Disabled = "disabled";
}


@if (string.IsNullOrEmpty(Id))
{
    Id = Guid.NewGuid().ToString();
}

@*@if (string.IsNullOrEmpty(CSSClass))
    {
        CSSClass = "form-control";
    }*@

@if (LabelDown)
{
    CSSClass = "mat-input";
    LabelCSS = "mat-label";
    DivCSS = "mat-div mat-div-sp";

}

@if (@ChildContent != null && string.IsNullOrEmpty(Type))
{
   
    Type = Types.select;
}


@switch (Type.ToLower().Trim())
{
    case Types.numberdecimallabel:


        @if (string.IsNullOrEmpty(StepResol) || StepResol == "0")
        {
            StepResol = "any";
        }

        <div class="@DivCSS" style="margin-top:0px;margin-bottom:0rem">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <input class="@CSSClass @CssClass @CssClassDecimal" id="@Id" @bind="@CurrentValue2" min="@Min.ToString()"
                   @oninput="ChangeWindow" type="number" disabled="disabled" step="@StepResol" 
                   @onblur:preventDefault @onclick:stopPropagation="true" @onclick:preventDefault />

            @GetErrorMessage(ErrorMessage)


        </div>
        break;

    case Types.numberdecimal:


        @if (string.IsNullOrEmpty(StepResol) || StepResol == "0")
        {
            StepResol = "any";
        }

        <div class="@DivCSS" style="margin-top:0px;margin-bottom:0rem">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <input class="@CSSClass @CssClass @CssClassDecimal" id="@Id" @bind="@CurrentValue2" @ref="SelfControl"
                    type="number" disabled="@IsDisabled" step="@StepResol" @onblur:preventDefault @onclick:stopPropagation="true" @onclick:preventDefault />

            @GetErrorMessage(ErrorMessage)


        </div>
        break;

    case Types.number:



        @if (string.IsNullOrEmpty(StepResol) || StepResol == "0")
        {
            StepResol = "any";
        }
        @*<div class="form-control-wrapper" style="margin-top:15px">@onkeypress:preventDefault*@
<div class="@DivCSS" style="margin-top:0px;margin-bottom:0rem">
    @if (!string.IsNullOrWhiteSpace(Label))
    {
        <label class="@LabelCSS" for="@Id">@Label</label>
    }
    @*<input class="@CSSClass @CssClass" id="@Id" @bind="@CurrentValueAsString"
        @oninput="ChangeWindow"
        type=@Type.ToLower()
        disabled="@IsDisabled"
        step="@StepResol"
        @onblur:preventDefault
        @onclick:stopPropagation="true"
        @onclick:preventDefault />*@
    <input class="@CSSClass @CssClass" id="@Id" @bind="@CurrentValueAsString"
           
           type=@Type.ToLower()
           disabled="@IsDisabled"
           step="@StepResol"
           @onblur:preventDefault
           @onclick:stopPropagation="true"
           @onclick:preventDefault />
    @*@if (LabelDown)
        {
            if (string.IsNullOrWhiteSpace(Label))
            {
                Label = "";
            }

            <label class="@LabelCSS" for="@Id">@Label</label>
        }*@

    @GetErrorMessage(ErrorMessage)

    @*<div class="@CSSValidationMessage">


            @ErrorMessage

        </div>*@
</div>
        break;


    case Types.PassWord:

        @*<div class="form-control-wrapper" style="margin-top:15px">@onkeypress:preventDefault*@
        <div class="form-group" style="margin-top:0px;margin-bottom:0rem">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <input class="@CSSClass @CssClass" id="@Id" @bind="@CurrentValueAsString"
                   @oninput="ChangeWindow" type=@Type.ToLower() disabled="@IsDisabled" />
            @*@if (LabelDown)
                {
                    if (string.IsNullOrWhiteSpace(Label))
                    {
                        Label = "";
                    }

                    <label class="@LabelCSS" for="@Id">@Label</label>
                }*@

            @GetErrorMessage(ErrorMessage)

            @*<div class="@CSSValidationMessage">


                    @ErrorMessage

                </div>*@
        </div>
        break;


    case Types.text:

        @*<div class="form-control-wrapper" style="margin-top:15px">@onkeypress:preventDefault*@
        <div class="@DivCSS" style="margin-top:0px;margin-bottom:0rem">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }

            <input class="@CSSClass @CssClass" id="@Id" @bind="@CurrentValueAsString"
                   @oninput="ChangeWindow" type=@Type.ToLower() disabled="@IsDisabled" />
            @*@if ( LabelDown)
                {
                    if (string.IsNullOrWhiteSpace(Label))
                    {
                        Label = "";
                    }

                    <label class="@LabelCSS" for="@Id">@Label</label>
                }*@

            @GetErrorMessage(ErrorMessage)

            @*<div class="@CSSValidationMessage">


                    @ErrorMessage

                </div>*@
        </div>
        break;

    case Types.Switch:

        if (Model == null)
        {
            <div class="custom-control custom-switch" style="@Style">
                <input type="checkbox" class="custom-control-input @CssClass" id="@Id" @oninput="ChangeWindow"
                       disabled="@IsDisabled" @bind="@CurrentValue">
                @if (!string.IsNullOrWhiteSpace(Label))
                {
                    <label class="custom-control-label" for="@Id">@Label</label>
                }
            </div>
        }
        else
        {
            <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input @CssClass" id="@Id" @oninput="ChangeObject"
                       disabled="@IsDisabled" @bind="@CurrentValue">
                @if (!string.IsNullOrWhiteSpace(Label))
                {
                    <label class="custom-control-label" for="@Id">@Label</label>
                }
            </div>

        }
        break;


    case Types.ReadOnlySwitch:


        <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input @CssClass" id="@Id" disabled value="@CurrentValueAsString">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="custom-control-label" for="customSwitch2">@Label</label>
            }
        </div>

        break;


    case Types.checkbox:
        <input class="form-check-input
               @CssClass" type="checkbox" id="@Id"
               @oninput="ChangeWindow"
               value="@CurrentValueAsString">
        break;


    case Types.ReadOnlyText:
        <div class="@DivCSS" style="margin-top:0px;margin-bottom:0rem">

            @if (!string.IsNullOrWhiteSpace(Label) && !LabelDown)
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <label class="@CSSClass @CssClass">@CurrentValueAsString</label>
            @*@if (!string.IsNullOrWhiteSpace(Label) && LabelDown)
                {
                    <label class="@LabelCSS" for="@Id">@Label</label>
                }*@
            @GetErrorMessage(ErrorMessage)
        </div>
        break;


    case Types.label:

        <label class="@CssClass">@CurrentValueAsString</label>

        break;

    case Types.select:

        <div class="form-control-wrapper">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <select class="@CSSClass @CssClass" id="@Id" @bind="CurrentValueAsString" disabled="@IsDisabled" @oninput="ChangeWindow">
                @*@if (ShowDefaultOption)
                    {
                    <option value="0" hidden disabled>- Please Select -</option>
                    }*@
                @if (ShowDefaultOption)
                {
                    <option value="0" selected>- Please Select -</option>
                }
                @ChildContent
            </select>
            @*@if (!string.IsNullOrWhiteSpace(Label) && LabelDown)
                {
                    <label class="@LabelCSS" for="@Id">@Label</label>
                }*@
            @GetErrorMessage(ErrorMessage)
        </div>

        break;


    case Types.ReadOnlySelect:

        <div class="form-control-wrapper">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>}

            <select class="form-control @CssClass" id="@Id" @bind="CurrentValueAsString" disabled>
                @*@if (ShowDefaultOption)
                    {
                        <option value="0" hidden disabled>- Please Select -</option>
                    }*@
                @if (ShowDefaultOption)
                {
                    <option value="0" selected>- Please Select -</option>
                }
                @ChildContent
            </select>
            @GetErrorMessage(ErrorMessage)
        </div>
        break;

    case Types.datetime:

        <div class="@DivCSS">
            @if (!IsDisabled)
            {

                @if (!string.IsNullOrWhiteSpace(Label))
                {
                    <label class="@LabelCSS" for="@Id">@Label</label>
                }
                @*<input class="form-control @CssClass" id="@Id" @bind="@CurrentValue"
                    @oninput="ChangeWindow" type="datetime"  />*@
                @*<InputDate @bind-Value="@CurrentValue" class="form-control @CssClass">
                    </InputDate>*@
                @*<DateTimePicker @bind-Value="@CurrentValue" placeholder="@Label" disabled="@IsDisabled" @oninput="ChangeObject"></DateTimePicker>*@
                @if (OnChangeObjectControl.HasDelegate)
                {
                    <InputDate @bind-Value="@CurrentValue" @oninput="ChangeObject" class="form-control">
                    </InputDate>
                }
                else
                {
                    <InputDate @bind-Value="@CurrentValue" @oninput="ChangeObject" class="form-control">
                    </InputDate>
                }

                @GetErrorMessage(ErrorMessage)

            }
            else
            {
                @if (!string.IsNullOrWhiteSpace(Label))
                {
                    <label class="@LabelCSS" for="@Id">@Label</label>
                }


                <InputDate @bind-Value="@CurrentValue" disabled="disabled" class="form-control">
                </InputDate>

            }




        </div>
        break;

    case Types.TextArea:
        <div class="form-control-wrapper">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <textarea class="@CSSClass @CssClass" id="@Id" @bind="@CurrentValueAsString" @oninput="ChangeWindow" disabled="@IsDisabled" />
            @GetErrorMessage(ErrorMessage)
        </div>
        break;


    case Types.ReadOnlyTextArea:
        <div class="@DivCSS">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }
            <textarea class="@CSSClass @CssClass" id="@Id" @bind="@CurrentValueAsString" disabled />
            @GetErrorMessage(ErrorMessage)
        </div>
        break;


    case Types.NotBindigText:
        <div class="@DivCSS">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <label class="@LabelCSS" for="@Id">@Label</label>
            }

            <input class="@CSSClass @CssClass" id="@Id" @oninput="ChangeWindow" />

        </div>
        break;





    default:
        <div>Not implemented control, please check with your administrator</div>
        break;


}

@*<div class="group">
        <input type="text" required>
        <span class="highlight"></span>
        <span class="bar"></span>
        <label>Name</label>
    </div>*@


@code {

    public bool ToastLunch { get; set; }

    private string _currentValue2;

    private string _currentValueTemp;

    public string CurrentValue2
    {
        get
        {
            //try
            //{


            //    if (StepResol=="any" || StepResol == "0" || DecimalNumbers < 0)
            //    {
            //        return CurrentValueAsString;
            //    }

            //    if(double.TryParse(CurrentValueAsString, NumberStyles.Any, CultureInfo.CurrentCulture, out var parsedValue))
            //    {



            //        if (DecimalRoundType == RoundType.Without)
            //        {
            //            parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
            //            if (TypeValue == typeof(int) && parsedValue == 0 && EnableToastMessage
            //                && !string.IsNullOrEmpty(ToastMessage)
            //                && _currentValueTemp == CurrentValueAsString)
            //            {
            //                ShowToast(ToastMessage, Blazor.Controls.Toast.ToastLevel.Warning).ConfigureAwait(false).GetAwaiter().GetResult();
            //                _currentValueTemp = CurrentValueAsString;
            //                WasRounded = true;
            //            }
            //        }



            //        var mult = 1;
            //        for (int iii = 0; iii < DecimalNumbers; iii++)
            //        {
            //            mult = mult * 10;
            //        }

            //        if (DecimalRoundType == RoundType.Ceiling)
            //        {
            //            //int vall = (int)parsedValue * mult;


            //            parsedValue = Math.Ceiling(parsedValue);
            //            parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
            //        }



            //        if (DecimalRoundType == RoundType.Normal)
            //        {


            //            parsedValue = Math.Round(parsedValue, DecimalNumbers);


            //        }

            //        if (DecimalRoundType == RoundType.Floor)
            //        {


            //            parsedValue = Math.Floor(parsedValue);
            //            parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
            //        }

            //        if (!string.IsNullOrEmpty(StepResol) && StepResol != "any" && StepResol != "0" && double.TryParse(StepResol, NumberStyles.Any, CultureInfo.CurrentCulture, out var parsedValue3))
            //        {

            //            if (DecimalRoundType == RoundType.RoundToResolution)
            //            {
            //                parsedValue = (Math.Round(parsedValue / parsedValue3, MidpointRounding.AwayFromZero)) * parsedValue3; // 1.25
            //                parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
            //            }

            //            if (EnableToastMessage && !string.IsNullOrEmpty(ToastMessage) && (Convert.ToDouble(CurrentValueAsString) != parsedValue) && _currentValueTemp != CurrentValueAsString)
            //            {
            //                var ms = string.Format(ToastMessage, CurrentValueAsString, parsedValue);

            //                ShowToast(ms, Blazor.Controls.Toast.ToastLevel.Warning).ConfigureAwait(false).GetAwaiter().GetResult();

            //                ToastLunch = true;

            //                _currentValueTemp = CurrentValueAsString;

            //                WasRounded=true;

            //                Console.WriteLine("showtoast");
            //            }

            //            var cssinvalid = parsedValue.GetInvalidClass(parsedValue3,DecimalNumbers);

            //            if (ChangeBackground && !string.IsNullOrEmpty(cssinvalid))
            //            {
            //                CssClassDecimal = cssinvalid;
            //                //in Testpoint (weight) the typed value XX was rounded to XX



            //            }
            //            else
            //            {
            //                CssClassDecimal = "";
            //            }

            //        }


            //        var parsedValue2 = parsedValue.ToString();

            //        var position = parsedValue2.IndexOf(".");

            //        var lengt = 0;

            //        if(position > 0)
            //            lengt =parsedValue2.Substring(position+1).Length;

            //        var dif = DecimalNumbers - lengt;




            //        //if (parsedValue.IsInt())
            //        if (dif > 0)
            //        {
            //            if (DecimalRoundType == RoundType.RoundToResolution)
            //            {

            //            }
            //            var zeros = "";
            //            for (int i = 0; i < dif; i++)
            //            {
            //                zeros = zeros + "0";
            //            }
            //            if (!string.IsNullOrEmpty(zeros) && position==-1)
            //            {
            //                parsedValue2 = parsedValue2 + "." + zeros;
            //            }
            //            else if(!string.IsNullOrEmpty(zeros) && position >0)
            //            {
            //                parsedValue2 = parsedValue2  + zeros;

            //            }

            //        }

            //        //var a = parsedValue2; //String.Format("{0:0.00}", parsedValue2);
            //        if(WasRounded){
            //            CssClassDecimal = CssClassDecimal + " warningcolor";
            //        }

            //        //CurrentValueAsString= parsedValue2;

            //        return parsedValue2;


            //    }
            //    else
            //    {
            //        return CurrentValueAsString;
            //    }


            //}
            //catch (Exception ex)
            //{
            //    Console.WriteLine("error textinput");
            //    return CurrentValueAsString;
            //}


            return RoundedFunction2(CurrentValueAsString);
        }
        set
        {
            var temp = value;
            //Console.WriteLine("set CurrentValueAsString");
            CurrentValueAsString = RoundedFunction(temp);
        }
    }



    public string RoundedFunction(string currentString)
    {

        try
        {


            if (StepResol == "any" || StepResol == "0" || DecimalNumbers < 0)
            {
                return currentString;
            }

            if (double.TryParse(currentString, NumberStyles.Any, CultureInfo.CurrentCulture, out var parsedValue))
            {



                if (DecimalRoundType == RoundType.Without)
                {
                    parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                    if (TypeValue == typeof(int) && parsedValue == 0 && EnableToastMessage
                        && !string.IsNullOrEmpty(ToastMessage)
                        && _currentValueTemp == currentString)
                    {
                        ShowToast(ToastMessage, Blazor.Controls.Toast.ToastLevel.Warning).ConfigureAwait(false).GetAwaiter().GetResult();
                        _currentValueTemp = currentString;
                        WasRounded = true;
                    }
                }



                var mult = 1;
                for (int iii = 0; iii < DecimalNumbers; iii++)
                {
                    mult = mult * 10;
                }

                if (DecimalRoundType == RoundType.Ceiling)
                {
                    //int vall = (int)parsedValue * mult;


                    parsedValue = Math.Ceiling(parsedValue);
                    parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                }



                if (DecimalRoundType == RoundType.Normal)
                {


                    parsedValue = Math.Round(parsedValue, DecimalNumbers);


                }

                if (DecimalRoundType == RoundType.Floor)
                {


                    parsedValue = Math.Floor(parsedValue);
                    parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                }

                if (!string.IsNullOrEmpty(StepResol) && StepResol != "any" && StepResol != "0" && double.TryParse(StepResol, NumberStyles.Any, CultureInfo.CurrentCulture, out var parsedValue3))
                {

                    if (DecimalRoundType == RoundType.RoundToResolution)
                    {
                        parsedValue = (Math.Round(parsedValue / parsedValue3, MidpointRounding.AwayFromZero)) * parsedValue3; // 1.25
                        parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                    }

                    if (EnableToastMessage && !string.IsNullOrEmpty(ToastMessage) && (Convert.ToDouble(currentString) != parsedValue) && _currentValueTemp != currentString)
                    {
                        var ms = string.Format(ToastMessage, currentString, parsedValue);

                        ShowToast(ms, Blazor.Controls.Toast.ToastLevel.Warning).ConfigureAwait(false).GetAwaiter().GetResult();

                        ToastLunch = true;

                        _currentValueTemp = currentString;

                        WasRounded = true;

                        //Console.WriteLine("showtoast");
                    }

                    var cssinvalid = parsedValue.GetInvalidClass(parsedValue3, DecimalNumbers);

                    if (ChangeBackground && !string.IsNullOrEmpty(cssinvalid))
                    {
                        CssClassDecimal = cssinvalid;
                        //in Testpoint (weight) the typed value XX was rounded to XX



                    }
                    else
                    {
                        CssClassDecimal = "";
                    }

                }


                var parsedValue2 = parsedValue.ToString();

                var position = parsedValue2.IndexOf(".");

                var lengt = 0;

                if (position > 0)
                    lengt = parsedValue2.Substring(position + 1).Length;

                var dif = DecimalNumbers - lengt;




                //if (parsedValue.IsInt())
                if (dif > 0)
                {
                    if (DecimalRoundType == RoundType.RoundToResolution)
                    {

                    }
                    var zeros = "";
                    for (int i = 0; i < dif; i++)
                    {
                        zeros = zeros + "0";
                    }
                    if (!string.IsNullOrEmpty(zeros) && position == -1)
                    {
                        parsedValue2 = parsedValue2 + "." + zeros;
                    }
                    else if (!string.IsNullOrEmpty(zeros) && position > 0)
                    {
                        parsedValue2 = parsedValue2 + zeros;

                    }

                }

                //var a = parsedValue2; //String.Format("{0:0.00}", parsedValue2);
                if (WasRounded)
                {
                    CssClassDecimal = CssClassDecimal + " warningcolor";
                }

                //currentString= parsedValue2;

                return parsedValue2;


            }
            else
            {
                return currentString;
            }


        }
        catch (Exception ex)
        {
            //Console.WriteLine("error textinput");
            return currentString;
        }



    }

    public string RoundedFunction2(string currentString)
    {

        try
        {


            if (StepResol == "any" || StepResol == "0" || DecimalNumbers < 0)
            {
                return currentString;
            }

            if (double.TryParse(currentString, NumberStyles.Any, CultureInfo.CurrentCulture, out var parsedValue))
            {



                if (DecimalRoundType == RoundType.Without)
                {
                    parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                    if (TypeValue == typeof(int) && parsedValue == 0 && EnableToastMessage
                        && !string.IsNullOrEmpty(ToastMessage)
                        && _currentValueTemp == currentString)
                    {
                        
                        _currentValueTemp = currentString;
                        WasRounded = true;
                    }
                }



                var mult = 1;
                for (int iii = 0; iii < DecimalNumbers; iii++)
                {
                    mult = mult * 10;
                }

                if (DecimalRoundType == RoundType.Ceiling)
                {
                    //int vall = (int)parsedValue * mult;


                    parsedValue = Math.Ceiling(parsedValue);
                    parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                }



                if (DecimalRoundType == RoundType.Normal)
                {


                    parsedValue = Math.Round(parsedValue, DecimalNumbers);


                }

                if (DecimalRoundType == RoundType.Floor)
                {


                    parsedValue = Math.Floor(parsedValue);
                    parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                }

                if (!string.IsNullOrEmpty(StepResol) && StepResol != "any" && StepResol != "0" && double.TryParse(StepResol, NumberStyles.Any, CultureInfo.CurrentCulture, out var parsedValue3))
                {

                    if (DecimalRoundType == RoundType.RoundToResolution)
                    {
                        parsedValue = (Math.Round(parsedValue / parsedValue3, MidpointRounding.AwayFromZero)) * parsedValue3; // 1.25
                        parsedValue = parsedValue.ToStringNoTruncate(DecimalNumbers);
                    }

                    if (EnableToastMessage && !string.IsNullOrEmpty(ToastMessage) && (Convert.ToDouble(currentString) != parsedValue) && _currentValueTemp != currentString)
                    {
                        

                        _currentValueTemp = currentString;

                        WasRounded = true;

                        //Console.WriteLine("showtoast");
                    }

                    var cssinvalid = parsedValue.GetInvalidClass(parsedValue3, DecimalNumbers);

                    if (ChangeBackground && !string.IsNullOrEmpty(cssinvalid))
                    {
                        CssClassDecimal = cssinvalid;
                        //in Testpoint (weight) the typed value XX was rounded to XX



                    }
                    else
                    {
                        CssClassDecimal = "";
                    }

                }


                var parsedValue2 = parsedValue.ToString();

                var position = parsedValue2.IndexOf(".");

                var lengt = 0;

                if (position > 0)
                    lengt = parsedValue2.Substring(position + 1).Length;

                var dif = DecimalNumbers - lengt;




                //if (parsedValue.IsInt())
                if (dif > 0)
                {
                    if (DecimalRoundType == RoundType.RoundToResolution)
                    {

                    }
                    var zeros = "";
                    for (int i = 0; i < dif; i++)
                    {
                        zeros = zeros + "0";
                    }
                    if (!string.IsNullOrEmpty(zeros) && position == -1)
                    {
                        parsedValue2 = parsedValue2 + "." + zeros;
                    }
                    else if (!string.IsNullOrEmpty(zeros) && position > 0)
                    {
                        parsedValue2 = parsedValue2 + zeros;

                    }

                }

                //var a = parsedValue2; //String.Format("{0:0.00}", parsedValue2);
                if (WasRounded)
                {
                    CssClassDecimal = CssClassDecimal + " warningcolor";
                }

                //currentString= parsedValue2;

                return parsedValue2;


            }
            else
            {
                return currentString;
            }


        }
        catch (Exception ex)
        {
            //Console.WriteLine("error textinput");
            return currentString;
        }



    }
}
